# 0 资料

[配置要求](https://docs.omniverse.nvidia.com/isaacsim/latest/installation/requirements.html?highlight=requ#system-requirements)
- [Isaac Sim Documentation](https://docs.omniverse.nvidia.com/isaacsim/latest/overview.html)
- [Extensions](https://docs.omniverse.nvidia.com/extensions/latest/index.html)
- [Forum](https://forums.developer.nvidia.com/)
NVIDIA Omniverse Discord Channel：**Omniverse Apps频道下的Isaac_Sim
[视频](https://www.bilibili.com/video/BV11z421q7Yz/?spm_id_from=333.788.recommend_more_video.-1&vd_source=4f10315acd30a6491a3fb1f267a3a517)
## 1 文档
- [Omniverse Documentation](https://docs.omniverse.nvidia.com/)
- [Isaac Sim Documentation](https://docs.omniverse.nvidia.com/isaacsim/latest/overview.html)
- [Forum](https://forums.developer.nvidia.com/c/agx-autonomous-machines/isaac/67)
- NVIDIA Omniverse Discord Channel：**Omniverse Apps频道下的Isaac_Sim
- [Extensions](https://docs.omniverse.nvidia.com/extensions/latest/index.html)
	- [Isaac Lab Documentation](https://isaac-sim.github.io/IsaacLab/)
	- [Replicator Documentation](https://docs.omniverse.nvidia.com/extensions/latest/ext_replicator.html)
	- [OmniGraph](https://docs.omniverse.nvidia.com/extensions/latest/ext_omnigraph.html)
	- [Simulation](https://docs.omniverse.nvidia.com/extensions/latest/ext_physics/simulation-control/physics-settings.html#physics-simulation-management)
		- 使用 [UI 调试可视化](https://docs.omniverse.nvidia.com/extensions/latest/ext_physics/simulation-control/physics-settings.html#debug-viz "(in Omniverse Extensions)")、[物理调试窗口中](https://docs.omniverse.nvidia.com/extensions/latest/ext_physics/simulation-control/physics-settings.html#physics-debug-window "(in Omniverse Extensions)")的运行时可视化选项或 [Omniverse Visual Debugger](https://nvidia-omniverse.github.io/PhysX/physx/5.3.1/docs/OmniVisualDebugger.html) 分析和调试仿真问题
- [NVIDIA PhysX](https://nvidia-omniverse.github.io/PhysX/physx/5.3.1/index.html)
	- 核心文档[Physics Core](https://docs.omniverse.nvidia.com/extensions/latest/ext_physics.html)
	- 编程指南[Physics Extensions](https://docs.omniverse.nvidia.com/kit/docs/omni_physics/latest/extensions/index.html)
	- 类[Schema](https://docs.omniverse.nvidia.com/kit/docs/omni_usd_schema_physics/latest/annotated.html)
	- [仿真限制列表](https://docs.omniverse.nvidia.com/isaacsim/latest/simulation_fundamentals.html#isaac-sim-physx-limitations)

补充：
- [NVIDIA Isaac ROS](https://nvidia-isaac-ros.github.io/)
- [Omniverse USD Composer(用户界面)](https://docs.omniverse.nvidia.com/composer/latest/interface.html)
- [USD Documentation](https://openusd.org/release/intro.html)
- [有用的链接](https://docs.omniverse.nvidia.com/isaacsim/latest/shortcuts.html#)
- [Development Tools](https://docs.omniverse.nvidia.com/isaacsim/latest/development_tools_tutorials.html#development-tools "Permalink to this headline")
- [Materials and Rendering](https://docs.omniverse.nvidia.com/materials-and-rendering/latest/index.html)
- [cuRobo: CUDA Accelerated Robot Library](https://curobo.org/)

工具：
- [Omniverse Streaming Client](https://docs.omniverse.nvidia.com/streaming-client/latest/user-manual.html)

API文档：
	- [Isaac Sim API 文档](https://docs.omniverse.nvidia.com/py/isaacsim/index.html)
	- [Omniverse API 文档](https://docs.omniverse.nvidia.com/kit/docs/kit-manual/latest/guide/kit_overview.html)

USD资产：
- [USD Assets Working Group](https://github.com/usd-wg/assets#usd-assets-working-group)
- [USD Search](https://build.nvidia.com/nvidia/usdsearch)
- [官方资产](https://docs.omniverse.nvidia.com/launcher/latest/it-managed-launcher/content_install.html#)

Isaac Sim 提供了一套工具，用于使用 [Replicator](https://docs.omniverse.nvidia.com/extensions/latest/ext_replicator.html) 收集合成数据，通过 [Omnigraph](https://docs.omniverse.nvidia.com/extensions/latest/ext_omnigraph.html) 编排模拟环境，调整 [PhysX 模拟](https://docs.omniverse.nvidia.com/extensions/latest/ext_simulation.html)参数以匹配现实，最后通过 [Isaac Lab](https://docs.omniverse.nvidia.com/isaacsim/latest/isaac_lab_tutorials/index.html#isaac-lab-tutorials-page) 的强化学习 （RL） 等各种方法训练控制代理。

## 2 学习进度
### [Isaac Sim Documentation](https://docs.omniverse.nvidia.com/isaacsim/latest/overview.html)

- [x] Isaac Sim ✅ 2024-10-17
	- [x] What Is Isaac Sim ✅ 2024-10-17
	- [x] Release Notes ✅ 2024-10-17
	- [x] Installation ✅ 2024-10-17
	- [x] Isaac Sim Conventions ✅ 2024-10-17
	- [x] Isaac Sim Developer Forums ✅ 2024-10-17
	- [x] Frequently Asked Questions ✅ 2024-10-17
- [x] OMNIVERSE, USD, PHYSICS ✅ 2024-10-17
	- [x] Omniverse Useful Links ✅ 2024-10-17
	- [x] Tips ✅ 2024-10-17
	- [x] OpenUSD Fundamentals ✅ 2024-10-17
	- [x] Physics ✅ 2024-10-17
	- [x] Isaac Sim Speedup Cheat Sheet ✅ 2024-10-17
- [ ] TUTORIALS
	- [x] Isaac Sim UI and Workflow Tutorials ✅ 2024-10-17
	- [x] Build Your First Virtual World ✅ 2024-10-18
	- [x] Development Tools ✅ 2024-11-06
	- [x] Core API ✅ 2024-11-07
	- [x] Scene Setup ✅ 2024-11-07
	- [x] ROS and ROS2(no Nav MulNav) ✅ 2024-11-08
	- [x] Isaac Lab(浅入) ✅ 2024-11-08
	- [ ] Replicator
	- [x] Motion Generation(浅入) ✅ 2024-11-08
		- [x] [NVIDIA cuMotion](https://nvidia-isaac-ros.github.io/concepts/manipulation/index.html#nvidia-cumotion) 在 ISAAC 3.0 中作为开发人员预览版提供，是一个用于操纵器的生产运动生成包。当前版本利用 cuRobo 作为其后端，通过 [MoveIt 2](https://moveit.picknik.ai/) 插件和一组支持的 ROS 2 包提供无碰撞的运动规划。 ✅ 2024-11-08
- [ ] EXTENSIONS
	- [ ] Scene Setup and Assets
	- [ ] Robot Simulation
	- [ ] Sensors Simulation
	- [ ] Debugging
	- [ ] Mapping
	- [ ] Warehouse Logistics
	- [ ] Motion Generation
	- [ ] Cortex
- [x] SCRIPTING GUIDES ✅ 2024-11-08
	- [x] Python Environment ✅ 2024-11-08
	- [x] Scene Setup ✅ 2024-11-08
	- [x] **Robot Simulation** ✅ 2024-11-08
	- [x] Util Snippets ✅ 2024-11-08
- [x] API DOCUMENTATION ✅ 2024-10-18
	- [x] [Isaac Sim API 文档](https://docs.omniverse.nvidia.com/py/isaacsim/index.html) ✅ 2024-10-18
	- [x] [Omniverse API 文档](https://docs.omniverse.nvidia.com/kit/docs/kit-manual/latest/guide/kit_overview.html) ✅ 2024-10-18
- [x] REFERENCE INFORMATION ✅ 2024-10-18
	- [x] Omniverse Isaac Sim Glossary ✅ 2024-10-18
	- [x] Keyboard Shortcuts Reference ✅ 2024-10-18
	- [x] User Interface Reference ✅ 2024-10-18
- [x] OMNIVERSE COMMON OMNIVERSE ✅ 2024-10-18
	- [x] Omniverse Glossary of Terms ✅ 2024-10-18
	- [x] Feedback and Forums ✅ 2024-10-18
	- [x] Omniverse Licenses ✅ 2024-10-18

### [Extensions](https://docs.omniverse.nvidia.com/extensions/latest/index.html)

- [ ] Core
- [ ] Animation
- [ ] Bridges
- [ ] Converters
- [ ] Design
- [ ] Digital Twins
- [ ] Materials
- [ ] [OmniGraph](https://docs.omniverse.nvidia.com/extensions/latest/ext_omnigraph.html)
- [ ] Product Configurator
- [ ] Programming
- [ ] Replicator
- [ ] [Simulation](https://docs.omniverse.nvidia.com/extensions/latest/ext_simulation.html#simulation-extensions)
- [ ] Streaming
- [ ] Utility
- [ ] 3rd Party

- [ ] Formats
- [ ] Technical Requirements
- [ ] Omniverse Glossary of Terms
- [ ] Feedback and Forums
- [ ] Omniverse Licenses
- [ ] Data Collection & Usage
- [ ] Cameras
- [ ] Preferences Panel


# 1 笔记

## 1 注意
- 激光雷达不支持高反光物体
- window->extensions安装插件
- isaaclab<-legged_gym
- isaacsim<-isaacgym
- omniverse://localhost/NVIDIA/Samples/Marbles
- [快捷键](https://docs.omniverse.nvidia.com/isaacsim/latest/reference_material/reference_keyboard_shortcuts.html#isaac-sim-keyboard-shortcuts)
- 除非要模拟上百个刚体和机器人，否则使用CPU求解会比GPU更好。 **Disable GPU dynamics** and use **MBP Broadphase** inside the Physics Scene’s _Property_ tab
- 添加关节：请单击父主体，然后单击子主体。在两个形体都高亮显示的情况下，右键单击并选择 _Create > Physics > Joints > Revolute Joint_。`RevoluteJoint` 子主体下。
- 有关节后，可以通过按住 `Shift` 键并在视区中单击并拖动机器人的任何部分来拖动机器人。
- _Windows > Extensions_，搜索 Isaac Sim REPL，如果尚未启用，请启用它。打开一个新终端，然后在命令行上运行 `telnet localhost 8223`。Python shell 在终端中启动，您已准备好开始通过 Python 与 Isaac Sim 中打开的舞台进行交互
- 关节控制：
	- 位置控制：刚度 >> 阻尼
	- 速度控制：刚度 = 0
- ROS 2 发布实时因子
	- _Isaac Utils > Common Omnigraphs > ROS2 Generic Publisher_.
	- 帧计算如下 `RTF = simulated_elapsed_time / real_elapsed_time` 。如果 RTF > 1，则模拟时间运行得比挂钟时间快。如果 RTF < 1，则模拟运行速度比实时慢

![[Pasted image 20241107193357.png]]

## 2 约定Conventions
https://docs.omniverse.nvidia.com/isaacsim/latest/reference_conventions.html

## 3 仿真时间

模拟的运行速度可能比渲染更快，这意味着对于每个渲染的帧，后台中可能会发生多个模拟时间步长。在下面的简化示例中，模拟设置为以每秒 120 个时间步长运行，而渲染设置为每秒 60 帧，从而每个渲染帧产生两个物理步：
![[Pasted image 20241017153116.png]]
- OmniGraph 节点通常在预渲染事件上更新
- [修改帧率](https://docs.omniverse.nvidia.com/isaacsim/latest/simulation_fundamentals.html#configuring-frame-rate)

#### 加速仿真
https://docs.omniverse.nvidia.com/isaacsim/latest/reference_material/speedup_cheat_sheet.html
- **Physics Step Size（物理步长**）：物理步长决定了每个物理模拟步骤的时间间隔。较小的步长将导致更精确的仿真，但也需要更多的计算资源，从而减慢仿真速度。相反，较大的步长会加快模拟速度，但可能会导致物理场的精度降低。您可以使用 world.set_physics_step_size（step_size） 函数调整脚本中的物理步长，其中 step_size 是所需的步长（以秒为单位）
- **Minimum Simulation Frame Rate（最小模拟帧速率**）：最小模拟帧速率决定了每秒物理模拟步骤的最小数量。如果实际帧速率低于此值，模拟将减慢以保持物理特性的准确性。您可以使用 world.set_min_simulation_frame_rate（frame_rate） 函数在脚本中调整最小模拟帧速率，其中 frame_rate 是所需的帧速率（以每秒帧数为单位）。
- **使用 RTX 验证 – 实时模式**：（请参阅[此处](https://omniverse-content-production.s3-us-west-2.amazonaws.com/Assets/Isaac/Documentation/Isaac-Sim-Docs_4.0.0/materials-and-rendering/latest/rtx-renderer_rt.html)）请注意，这会影响不透明度，用户可能需要设置部分不透明度复选框
- ![[Pasted image 20241017155852.png]]
- **禁用材质和光源**：要获得更简单/更快的渲染
- **OV 求解器设置**：将求解器迭代次数降低到仍能获得可接受的仿真保真度的计数，将对性能有很大帮助。可以在场景中设置全局迭代钳制
- ![[Pasted image 20241017160005.png]]

## 4 Physics
- 由于时间是离散的，因此如果对象移动得太快，则在一个时间步长期间，对象位于平台上方，而在下一个时间步长中，对象已完全穿过平台，没有捕获碰撞。地平面不会发生这种情况，因为它实现了一个“力场”，将被穿透的物体推向地表。要解决此问题，请在物理场景中启用一个名为 **Enable CCD** （Continuous Collision Detection） 的选项。CCD 将对象从一个姿势扫描到下一个姿势。还必须在刚体本身中启用此选项：
	1. Select the Xform. 
	2. In the properties panel, enable CCD under the rigid body properties.  
- [刚体模拟](https://docs.omniverse.nvidia.com/extensions/latest/ext_physics/rigid-bodies.html "(in Omniverse Extensions)")和[碰撞设置](https://docs.omniverse.nvidia.com/extensions/latest/ext_physics/rigid-bodies.html#collisionsettings "(in Omniverse Extensions)")。
- [调整关节驱动增益](https://docs.omniverse.nvidia.com/isaacsim/latest/advanced_tutorials/tutorial_advanced_joint_tuning.html#isaac-sim-app-tutorial-advanced-joint-tuning)
-  [铰链Articulations](https://docs.omniverse.nvidia.com/extensions/latest/ext_physics/articulations.html#articulations "(in Omniverse Extensions)")

### 1 Quaternions
| API             | Representation   |
| --------------- | ---------------- |
| Isaac Sim Core  | (QW, QX, QY, QZ) |
| USD             | (QW, QX, QY, QZ) |
| PhysX           | (QX, QY, QZ, QW) |
| Dynamic Control | (QX, QY, QZ, QW) |

### 2 Angles
| API             | Representation |
| --------------- | -------------- |
| Isaac Sim Core  | Radians        |
| USD             | Degrees        |
| PhysX           | Radians        |
| Dynamic Control | Radians        |

## 5 开发工具
### 1 VS Code
![[Pasted image 20241106184648.png]]

![[Pasted image 20241106184821.png]]

## 6 场景性能优化
**最小化灯光数量**：每个灯光都会对渲染性能产生负面影响。默认情况下，如果场景有超过 10 个灯光，渲染将恢复为基于样本的灯光，以避免性能严重下降。
**减少半透明材质**：每种半透明材质都会比默认的 OmniPBR 材质产生更大的性能瓶颈。
**优化物理性能**：搜索可以修改以降低计算成本的模拟方面。通常，碰撞器的计算成本很高。碰撞形状越基础，模拟的性能就越高。减少接触点的数量也可以带来巨大的性能优势。对此进行调整可能需要进行多次实验才能达到适合您情况的最佳精度与性能点。

## 7 物理回调函数
![[Pasted image 20241114114039.png]]


## 8 相机

![[Pasted image 20241121174147.png]]
![[Pasted image 20241121174205.png]]
### 1 FOV
![[Pasted image 20241122100221.png]]
## 9 性能评估

单3090，1280 x 720图像，复杂场景

| 模式  | 帧率  | 三双目 |
| --- | --- | --- |
| 高性能 | 26  | 6   |
| 中性能 | 46  | 11  |
| 低性能 | 77  | 17  |

单3090，1280 x 720图像，简单场景

| 模式  | 帧率  | 三双目 |
| --- | --- | --- |
| 高性能 | 75  | 20  |
| 中性能 | 110 | 24  |
| 低性能 | 142 | 28  |

| **光追质量** | **直接照明<br>样本数/像素** | **间接漫射<br>样本数/像素** | **反射<br>样本数/像素** | **反射<br>最大反弹次数** | **反射<br>粗糙度缓存阈值**   | **次表面散射<br>最大采样数/帧** |
| -------- | ------------------ | ------------------ | ---------------- | ---------------- | ------------------- | -------------------- |
| 低        | 2                  | 1                  | 1                | 1                | 0.3                 | 16                   |
| 中        | 4                  | 1                  | 1                | 1                | 0.3                 | 32                   |
| 高        | 8                  | 2                  | 8                | 2                | <u>0.5（数值越低越真实）</u> | 32                   |

| **光追质量** | **透明度<br>最大折射反弹** | **透明度<br>折射反射可见性** | **透明度<br>二次反射吞吐阈值** | **透明度<br>景深校正（DoF）** | **透明度<br>运动矢量校正** | **透明度<br>粗糙度采样** |
| -------- | ----------------- | ------------------ | ------------------- | -------------------- | ----------------- | ---------------- |
| 低        | 1                 | 否                  | 无                   | 无                    | 无                 | 无                |
| 中        | 4                 | 是                  | 0.1                 | 是                    | 是                 | 是                |
| 高        | 8                 | 是                  | 0.1                 | 是                    | 是                 | 是                |

## 10 动力学参数

| 参数                         | 定义              | 作用          | 单位                |
| -------------------------- | --------------- | ----------- | ----------------- |
| **Enable Projection**      | 启动预测，修复关节约束偏差   | 自动修正误差      | true 或 false      |
| **Armature（惯性补偿）**         | 关节的虚拟惯性补偿       | 提高数值稳定性     | kg·m²             |
| **Damping（阻尼系数）**          | 阻尼系数，抵抗运动的速度相关项 | 防止震荡，平滑运动   | N·s/m 或 N·m·s/rad |
| **Stiffness（刚度系数）**        | 恢复力与变形的比例       | 模拟材料硬度      | N/m 或 N·m/rad     |
| **Restitution（恢复系数）**      | 碰撞恢复系数          | 控制碰撞后的反弹程度  | 无单位（[0, 1]）       |
| **Contact Distance（接触距离）** | 接触预测距离          | 提前预测碰撞，减少穿透 | 米（m）              |
| **Bounce Threshold（反弹阈值）** | 低速碰撞时忽略反弹的速度阈值  | 模拟低速无弹性碰撞   | 米/秒（m/s）          |

[调整关节驱动增益参考链接](https://docs.omniverse.nvidia.com/isaacsim/latest/advanced_tutorials/tutorial_advanced_joint_tuning.html#)
[Gain Tuner 扩展](https://docs.omniverse.nvidia.com/isaacsim/latest/features/robots_simulation/ext_omni_isaac_gain_tuner.html#gain-tuner-extension)

关节驱动是双比例控制器，用于将关节设置为给定目标。一个比例增益用于**调节位置误差**，而另一个增益用于**调节速度误差**。由于历史原因，这些增益分别称为 Stiffness 和 Damping。

- 位置控制：将 Stiffness 设置为大于零的值，Damping 可以是任何值。
- 速度控制：将 Stiffness 设定为零，并将 Damping  设定为大于 0 的任何值。
- 关节最大力将充当 的 τ 夹紧作用
![[Pasted image 20241127193222.png]]
- 驱动类型将决定力是直接作为扭矩/力施加，还是转换为施加到连接到关节的物体的加速度。

| 参数         | 定义                        | 作用                  | 单位            | 当前数值       |
| ---------- | ------------------------- | ------------------- | ------------- | ---------- |
| 质量（几何）     | 物体在仿真中所拥有的物质量             | 影响物体的加速和碰撞响应(反弹)    | kg            |            |
|            |                           |                     |               |            |
| 启动预测（关节）   | 是否启用关节约束偏差的修正机制           | 自动修正误差，防止关节不符合物理约束  | [True, False] | False      |
| 关节摩擦（关节）   | 关节运动过程中受到的摩擦力             | 抵抗关节运动，模拟实际摩擦效果     | N             | 0.0        |
| 最大关节速度（关节） | 关节运动的最大允许速度               | 限制关节速度，避免速度过高导致不稳定  | m/s           | 1000.0     |
| 惯性补偿（关节）   | 关节的虚拟惯性补偿，用于平衡惯性力         | 提高数值稳定性，减少震荡        | kg·m²         | 0.0        |
|            |                           |                     |               |            |
| 反弹阈值（转动关节） | 用于碰撞后的速度恢复限制，类似于阻尼系数（碰撞后） | 抑制碰撞后的反弹震荡，平滑运动     | N·m·s/rad     | 0.0        |
| 接触距离（转动关节） | 关节碰撞前的接触预测距离              | 提前预测并处理碰撞，减少穿透现象    | m             | 0.0        |
| 阻尼系数（转动关节） | 转动关节的阻尼系数，抵抗关节速度相关的运动趋势   | 防止震荡，平滑运动           | N·m·s/rad     | 0.0        |
| 恢复系数（转动关节） | 碰撞恢复系数，控制碰撞后恢复的能量比例       | 调整碰撞后的反弹程度          | [0, 1]        | 0.0        |
| 刚度系数（转动关节） | 关节的刚度，表示恢复力与变形的比例         | 模拟材料硬度，控制关节的弹性      | N·m/rad       | 0.0        |
|            |                           |                     |               |            |
| 类型（驱动）     | 控制关节运动的方式（力驱动或加速度驱动）      | 施加外部力使关节运动，或直接控制加速度 | [力, 加速度]      | 力          |
| 最大力（驱动）    | 所施加外部力的最大值                | 限制驱动所施加的力，防止过载      | N             | 1000.0     |
| 阻尼系数（驱动）   | 驱动器的阻尼系数，抵抗关节速度相关的运动趋势    | 防止震荡，平滑驱动运动         | N·m·s/rad     | 0.0        |
| 刚度系数（驱动）   | 驱动器的刚度，表示恢复力与变形的比例        | 模拟材料硬度，控制驱动器的弹性     | N·m/rad       | 10,000,000 |

| 名称       | 质量（kg）             | 名称       | 质量（kg）             |
| -------- | ------------------ | -------- | ------------------ |
| 底盘（不含升降） | 48.1409464093523   | 升降结构     | 46.3510500521532   |
| 左臂1      | 0.713973488385901  | 右臂1      | 0.71397            |
| 左臂2      | 1.22186838833907   | 右臂2      | 1.2219             |
| 左臂3      | 2.10512824302957   | 右臂3      | 2.10512824302958   |
| 左臂4      | 1.79906181586533   | 右臂4      | 1.79905918727178   |
| 左臂5      | 0.399989890772059  | 右臂5      | 0.399989890772061  |
| 左臂6      | 0.403608898205905  | 右臂6      | 0.403608898049363  |
| 左臂7      | 0.125448761870641  | 右臂7      | 0.125448761870641  |
| 左臂相机支架   | 0.108445227403675  | 右臂相机支架   | 0.108445227403676  |
| 左臂相机     | 0.0217509091830521 | 右臂相机     | 0.0217509091830496 |
| 左臂末端装配装置 | 0.117173765708346  | 左臂末端装配装置 | 0.117173765708345  |
| 左臂末端两指夹具 | 0.693029655061183  | 右臂末端两指夹具 | 0.693029655061183  |
| 云台关节1    | 0.028308647118592  | 云台关节2    | 0.0182760908413779 |
| 云台相机     | 0.024089503055058  |          |                    |
